---
layout: post
title: 动画
css: animate
date: 2020-06-08
Author: 念书
categories: 
tags: [CSS,JavaScript]
comments: true
---

渐变是过程,动画亦是过程.渐变是对已有的过程进行描述.而动画则是展示了正在进行的过程.是的,动画使得网页有了进行时.



## 基础篇

### jQuery中的动画

尽管jQuery 已经成为了很多人口中上古时代的js库.但是有项目依旧在使用它.

jq中的动画特别简单

最简单的 show()和hide()方法,可以传参数使得隐藏和展示有动画效果,例如hide(300),show("slow");

特地去看了一下源码其实也是调用了jQuery的animate方法

```javascript
animate: function( prop, speed, easing, callback ) {
    
}
```

第一个参数是参与动画的样式,show和hide的动画虽然修改了display,但是实际上是修改的width和height,

以下两行代码效果相同

```javascript
$("#box").toggle(10000);
$("#box").animate({width:"toggle",height:"toggle"},10000);
$("#box").animate({width:"0px",height:"0px"},10000);
$("#box").animate({width:"200px",height:"200px"},10000);
```

第二个参数是动画用的时间

第三个参数是动画采用的速度曲线,看了一下只有两种

```
jQuery.easing = {
	linear: function( p ) {
		return p;
	},
	swing: function( p ) {
		return 0.5 - Math.cos( p * Math.PI ) / 2;
	},
	_default: "swing"
};
```

第一种很明显就是线性的,匀速的.

第二种是用的余弦曲线,先慢后快再慢也就是ease![cos](https://s1.ax1x.com/2020/06/09/t5YnYV.png)

第四个参数是回调

核心代码如下

```javascript
function schedule() {
    if ( inProgress ) {
        if ( document.hidden === false && window.requestAnimationFrame ) {
            window.requestAnimationFrame( schedule );
        } else {
            window.setTimeout( schedule, jQuery.fx.interval );
        }

        jQuery.fx.tick();
    }
}
run: function( percent ) {
    var eased,
        hooks = Tween.propHooks[ this.prop ];

    if ( this.options.duration ) {
        this.pos = eased = jQuery.easing[ this.easing ](
            percent, this.options.duration * percent, 0, 1, this.options.duration
        );
    } else {
        this.pos = eased = percent;
    }
    this.now = ( this.end - this.start ) * eased + this.start;

    if ( this.options.step ) {
        this.options.step.call( this.elem, this.now, this );
    }

    if ( hooks && hooks.set ) {
        hooks.set( this );
    } else {
        Tween.propHooks._default.set( this );
    }
    return this;
}
set: function( tween ) {

    // Use step hook for back compat.
    // Use cssHook if its there.
    // Use .style if available and use plain properties where available.
    if ( jQuery.fx.step[ tween.prop ] ) {
        jQuery.fx.step[ tween.prop ]( tween );
    } else if ( tween.elem.nodeType === 1 && (
        jQuery.cssHooks[ tween.prop ] ||
        tween.elem.style[ finalPropName( tween.prop ) ] != null ) ) {
        jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
    } else {
        tween.elem[ tween.prop ] = tween.now;
    }
}
```



### CSS中的动画

#### transition

最开始的时候css动画都是靠transition属性来实现的
同样是4个参数,第四个参数是开始时间,
开始时间可以是负值,为正值时会延迟动画.为负值时会从中间阶段开始动画,负值超过动画时间,就没有了动画效果

```CSS
 transition: all 2s ease 1s;
 transition: all 2s ease -1s;
 transition: all 2s ease -2s;
```

<div id="box" class="box" ></div><div id="box1" class="box" ></div><div id="box1" class="box" ></div>

第三个参数也要复杂的多,有各种定义好的速度曲线(linear,ease,ease-in,ease-out,ease-in-out),也可以通过cubic-bezier(x1,y1,x2,y2)自定义.可以在[速度曲线](https://cubic-bezier.com/#.33,-0.79,.99,.4)测试不同曲线的效果. 这是数学中的三次贝塞尔曲线.

需要注意一点x1,x2必须在[0,1]范围内,y1,y2则不必(但也不要超出太多).y1,y2 为负数时会朝着反方向运行一段距离,y1,y2大于1时会超出动画范围一段距离.

```CSS
transition: all 2s cubic-bezier(2,2,2,2) 
transition: all 2s cubic-bezier(.03,-0.74,.83,.67)
transition: all 2s cubic-bezier(.05,.62,.88,1.52)
transition: all 2s cubic-bezier(.36,-0.79,.59,1.71)
```

<div id="box4" class="box"></div>
<div id="box5" class="box"></div>
<div id="box6" class="box"></div>
<div id="box7" class="box"></div>

transition 写起来很快,缺点也很明显,需要触发,而且部分属性不支持.比如display,其实也没关系,可以仿照上边jQ的写法,通过修改width,height来隐藏,同时加上opacity配合.